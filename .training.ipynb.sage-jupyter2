{"backend_state":"init","connection_file":"/projects/e5ac326b-8e23-49e3-8a5a-a6f96260b4dc/.local/share/jupyter/runtime/kernel-05c73efb-e9ae-4982-821c-22222b7b2cc9.json","kernel":"ds_env","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.12"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":0,"id":"ad0de4","input":"","pos":48,"type":"cell"}
{"cell_type":"code","exec_count":100,"id":"8bae2d","input":"# Hyper Parameter Tuning using GridSearchCV\n\nregressor_dt = DecisionTreeRegressor(random_state = 0)\nparameters = {\"criterion\" : [\"squared_error\", \"absolute_error\", \"poisson\"], \"max_depth\":[2,4,6,8,10], \"splitter\": [\"best\", \"random\"]}\ngrid_dt = GridSearchCV(estimator=regressor_dt, param_grid=parameters, cv= 4)\ngrid_dt.fit(train_X, train_Y)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-6 {color: black;background-color: white;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-6\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(cv=4, estimator=DecisionTreeRegressor(random_state=0),\n             param_grid={&#x27;criterion&#x27;: [&#x27;squared_error&#x27;, &#x27;absolute_error&#x27;,\n                                       &#x27;poisson&#x27;],\n                         &#x27;max_depth&#x27;: [2, 4, 6, 8, 10],\n                         &#x27;splitter&#x27;: [&#x27;best&#x27;, &#x27;random&#x27;]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-12\" type=\"checkbox\" ><label for=\"sk-estimator-id-12\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(cv=4, estimator=DecisionTreeRegressor(random_state=0),\n             param_grid={&#x27;criterion&#x27;: [&#x27;squared_error&#x27;, &#x27;absolute_error&#x27;,\n                                       &#x27;poisson&#x27;],\n                         &#x27;max_depth&#x27;: [2, 4, 6, 8, 10],\n                         &#x27;splitter&#x27;: [&#x27;best&#x27;, &#x27;random&#x27;]})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-13\" type=\"checkbox\" ><label for=\"sk-estimator-id-13\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: DecisionTreeRegressor</label><div class=\"sk-toggleable__content\"><pre>DecisionTreeRegressor(random_state=0)</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-14\" type=\"checkbox\" ><label for=\"sk-estimator-id-14\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">DecisionTreeRegressor</label><div class=\"sk-toggleable__content\"><pre>DecisionTreeRegressor(random_state=0)</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(cv=4, estimator=DecisionTreeRegressor(random_state=0),\n             param_grid={'criterion': ['squared_error', 'absolute_error',\n                                       'poisson'],\n                         'max_depth': [2, 4, 6, 8, 10],\n                         'splitter': ['best', 'random']})"},"exec_count":100,"output_type":"execute_result"}},"pos":38,"type":"cell"}
{"cell_type":"code","exec_count":101,"id":"0cb1f5","input":"# Finding the best parameters\ngrid_dt.best_params_","output":{"0":{"data":{"text/plain":"{'criterion': 'squared_error', 'max_depth': 8, 'splitter': 'random'}"},"exec_count":101,"output_type":"execute_result"}},"pos":39,"type":"cell"}
{"cell_type":"code","exec_count":102,"id":"4c1a1f","input":"dtr = DecisionTreeRegressor(criterion = \"absolute_error\", max_depth=10, splitter = \"best\")\ndtr.fit(train_X, train_Y)\ndecision_result = dtr.predict(test_X)\n\n# Evaluation Metrics\nprint(\"Mean Absolute Error: \", mean_absolute_error(np.array(test_Y), decision_result))\nprint(\"Mean Squared Error: \", mean_squared_error(test_Y, decision_result))\nprint(\"R-Squared value: \", r2_score(test_Y, decision_result))\n\n# Accuracy\nresultdt = dtr.score(test_X, test_Y)\nprint(\"Accuracy: \",resultdt)","output":{"0":{"name":"stdout","output_type":"stream","text":"Mean Absolute Error:  1338.7875\nMean Squared Error:  6826984.959375\nR-Squared value:  0.9930492974212604\nAccuracy:  0.9930492974212604\n"}},"pos":40,"type":"cell"}
{"cell_type":"code","exec_count":103,"id":"e8279e","input":"# Linear Regression Plot between prisoner count and total violent crimes\nsns.lmplot(x=\"prisoner_count\", y=\"violent_crime_total\",data=crime_df)","output":{"0":{"data":{"text/plain":"<seaborn.axisgrid.FacetGrid at 0x7f4bb8abe6a0>"},"exec_count":103,"output_type":"execute_result"},"1":{"data":{"image/png":"1f19b170b3126eadbf095716ad74cba541aea4cd","text/plain":"<Figure size 360x360 with 1 Axes>"},"exec_count":103,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":42,"type":"cell"}
{"cell_type":"code","exec_count":104,"id":"073397","input":"# Decision Tree\nplt.figure(figsize=(400,30))\na = tree.plot_tree(dtr,\n                   feature_names = training_features,\n                   class_names = crime_df['prisoner_count'],\n                   filled = True,\n                   fontsize=12)\nplt.show()","output":{"0":{"data":{"image/png":"8a70a903b86e18e8546a2e4f96d9277a6594b887","text/plain":"<Figure size 28800x2160 with 1 Axes>"},"exec_count":104,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":43,"type":"cell"}
{"cell_type":"code","exec_count":105,"id":"3c3741","input":"# Feature Importance in decision tree\npd.Series(dtr.feature_importances_, index = training_features).plot(kind = \"bar\")","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":105,"output_type":"execute_result"},"1":{"data":{"image/png":"8a9814055aaf2824ad08d86e097c3061dfca7ad6","text/plain":"<Figure size 432x288 with 1 Axes>"},"exec_count":105,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":44,"type":"cell"}
{"cell_type":"code","exec_count":106,"id":"1ced75","input":"# Feature importance in Random Forest\npd.Series(rfr.feature_importances_, index = training_features).plot(kind = \"bar\")","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":106,"output_type":"execute_result"},"1":{"data":{"image/png":"cd0c058758f292b513358309d88dddd74761ee15","text/plain":"<Figure size 432x288 with 1 Axes>"},"exec_count":106,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":45,"type":"cell"}
{"cell_type":"code","exec_count":107,"id":"ca61ad","input":"# Plot 4: Assault per state\n\nplt.figure(figsize=(30, 10))\nplt.bar(crime_df['jurisdiction'], crime_df['agg_assault'])\nplt.title('Aggravated Assault per State')\nplt.ylabel(\"Aggravated Assault\")\nplt.xlabel(\"States\")\nplt.xticks(rotation = 90)","output":{"0":{"data":{"image/png":"1422ccd484c7fe91b9a97476b3e559c0c6b01f31","text/plain":"<Figure size 2160x720 with 1 Axes>"},"exec_count":107,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":14,"type":"cell"}
{"cell_type":"code","exec_count":108,"id":"a6ef0e","input":"# Plot 6: Total Violent Crime based on the prisoner count\nplt.figure(figsize=(30, 10))\nplt.scatter(crime_df['violent_crime_total'], crime_df['prisoner_count'])\nplt.title('Total Violent Crime based on Prisoner Count')\nplt.ylabel(\"Violent Crime\")\nplt.xlabel(\"Prisoner Count\")\nplt.xticks(rotation = 80)","output":{"0":{"data":{"text/plain":"(array([-50000.,      0.,  50000., 100000., 150000., 200000., 250000.]),\n [Text(0, 0, ''),\n  Text(0, 0, ''),\n  Text(0, 0, ''),\n  Text(0, 0, ''),\n  Text(0, 0, ''),\n  Text(0, 0, ''),\n  Text(0, 0, '')])"},"exec_count":108,"output_type":"execute_result"},"1":{"data":{"image/png":"173fe6c094680b0236ddd8b807772b5c6982228c","text/plain":"<Figure size 2160x720 with 1 Axes>"},"exec_count":108,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":16,"type":"cell"}
{"cell_type":"code","exec_count":109,"id":"f1b032","input":"# Plot 7: Amount of prisoners per state\n\nsns.boxplot(x=\"prisoner_count\", data=crime_df.tail(50))\nplt.xlabel(\"Number of Prisoners\")\nplt.title(\"Amount of Prisoners per State\")","output":{"0":{"data":{"text/plain":"Text(0.5, 1.0, 'Amount of Prisoners per State')"},"exec_count":109,"output_type":"execute_result"},"1":{"data":{"image/png":"f467871151559fe3d4e68b73e9d20987f6c12b2d","text/plain":"<Figure size 432x288 with 1 Axes>"},"exec_count":109,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":17,"type":"cell"}
{"cell_type":"code","exec_count":73,"id":"4079cc","input":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport plotly.express as px\nimport math\n\nfrom sklearn import tree\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error, accuracy_score\n\nfrom sklearn.metrics import confusion_matrix","pos":2,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":74,"id":"9b1de5","input":"crime_df = pd.read_csv(\"crimes.csv\")","pos":4,"type":"cell"}
{"cell_type":"code","exec_count":75,"id":"2a4e09","input":"for x in range(17):\n    print(crime_df.columns.values[x], crime_df.iloc[:,x].isna().sum())\ncrime_df = crime_df.dropna(subset=['crime_reporting_change'])","output":{"0":{"name":"stdout","output_type":"stream","text":"jurisdiction 0\nincludes_jails 0\nyear 0\nprisoner_count 0\ncrime_reporting_change 17\ncrimes_estimated 17\nstate_population 17\nviolent_crime_total 17\nmurder_manslaughter 17\nrape_legacy 67\nrape_revised 617\nrobbery 17\nagg_assault 17\nproperty_crime_total 17\nburglary 17\nlarceny 17\nvehicle_theft 17\n"}},"pos":5,"type":"cell"}
{"cell_type":"code","exec_count":76,"id":"6d310a","input":"# Check for null values and remove null values from columns\n\ncrime_df['rape_legacy'] = crime_df['rape_legacy'].fillna(crime_df['rape_legacy'].mean())\ncrime_df.isnull().sum()","output":{"0":{"data":{"text/plain":"jurisdiction                0\nincludes_jails              0\nyear                        0\nprisoner_count              0\ncrime_reporting_change      0\ncrimes_estimated            0\nstate_population            0\nviolent_crime_total         0\nmurder_manslaughter         0\nrape_legacy                 0\nrape_revised              600\nrobbery                     0\nagg_assault                 0\nproperty_crime_total        0\nburglary                    0\nlarceny                     0\nvehicle_theft               0\ndtype: int64"},"exec_count":76,"output_type":"execute_result"}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":77,"id":"479b81","input":"crime_df","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>jurisdiction</th>\n      <th>includes_jails</th>\n      <th>year</th>\n      <th>prisoner_count</th>\n      <th>crime_reporting_change</th>\n      <th>crimes_estimated</th>\n      <th>state_population</th>\n      <th>violent_crime_total</th>\n      <th>murder_manslaughter</th>\n      <th>rape_legacy</th>\n      <th>rape_revised</th>\n      <th>robbery</th>\n      <th>agg_assault</th>\n      <th>property_crime_total</th>\n      <th>burglary</th>\n      <th>larceny</th>\n      <th>vehicle_theft</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>ALABAMA</td>\n      <td>False</td>\n      <td>2001</td>\n      <td>24741</td>\n      <td>False</td>\n      <td>False</td>\n      <td>4468912.0</td>\n      <td>19582.0</td>\n      <td>379.0</td>\n      <td>1369.000000</td>\n      <td>NaN</td>\n      <td>5584.0</td>\n      <td>12250.0</td>\n      <td>173253.0</td>\n      <td>40642.0</td>\n      <td>119992.0</td>\n      <td>12619.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>ALASKA</td>\n      <td>True</td>\n      <td>2001</td>\n      <td>4570</td>\n      <td>False</td>\n      <td>False</td>\n      <td>633630.0</td>\n      <td>3735.0</td>\n      <td>39.0</td>\n      <td>501.000000</td>\n      <td>NaN</td>\n      <td>514.0</td>\n      <td>2681.0</td>\n      <td>23160.0</td>\n      <td>3847.0</td>\n      <td>16695.0</td>\n      <td>2618.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>ARIZONA</td>\n      <td>False</td>\n      <td>2001</td>\n      <td>27710</td>\n      <td>False</td>\n      <td>False</td>\n      <td>5306966.0</td>\n      <td>28675.0</td>\n      <td>400.0</td>\n      <td>1518.000000</td>\n      <td>NaN</td>\n      <td>8868.0</td>\n      <td>17889.0</td>\n      <td>293874.0</td>\n      <td>54821.0</td>\n      <td>186850.0</td>\n      <td>52203.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>ARKANSAS</td>\n      <td>False</td>\n      <td>2001</td>\n      <td>11489</td>\n      <td>False</td>\n      <td>False</td>\n      <td>2694698.0</td>\n      <td>12190.0</td>\n      <td>148.0</td>\n      <td>892.000000</td>\n      <td>NaN</td>\n      <td>2181.0</td>\n      <td>8969.0</td>\n      <td>99106.0</td>\n      <td>22196.0</td>\n      <td>69590.0</td>\n      <td>7320.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>CALIFORNIA</td>\n      <td>False</td>\n      <td>2001</td>\n      <td>157142</td>\n      <td>False</td>\n      <td>False</td>\n      <td>34600463.0</td>\n      <td>212867.0</td>\n      <td>2206.0</td>\n      <td>9960.000000</td>\n      <td>NaN</td>\n      <td>64614.0</td>\n      <td>136087.0</td>\n      <td>1134189.0</td>\n      <td>232273.0</td>\n      <td>697739.0</td>\n      <td>204177.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>811</th>\n      <td>VIRGINIA</td>\n      <td>False</td>\n      <td>2016</td>\n      <td>29882</td>\n      <td>False</td>\n      <td>False</td>\n      <td>8414380.0</td>\n      <td>18495.0</td>\n      <td>482.0</td>\n      <td>1788.339119</td>\n      <td>2830.0</td>\n      <td>4826.0</td>\n      <td>10357.0</td>\n      <td>157292.0</td>\n      <td>20159.0</td>\n      <td>127285.0</td>\n      <td>9848.0</td>\n    </tr>\n    <tr>\n      <th>812</th>\n      <td>WASHINGTON</td>\n      <td>False</td>\n      <td>2016</td>\n      <td>17228</td>\n      <td>False</td>\n      <td>False</td>\n      <td>7280934.0</td>\n      <td>22101.0</td>\n      <td>195.0</td>\n      <td>1788.339119</td>\n      <td>3133.0</td>\n      <td>5649.0</td>\n      <td>13124.0</td>\n      <td>254994.0</td>\n      <td>49249.0</td>\n      <td>173423.0</td>\n      <td>32322.0</td>\n    </tr>\n    <tr>\n      <th>813</th>\n      <td>WEST VIRGINIA</td>\n      <td>False</td>\n      <td>2016</td>\n      <td>5899</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1828637.0</td>\n      <td>6633.0</td>\n      <td>85.0</td>\n      <td>1788.339119</td>\n      <td>684.0</td>\n      <td>720.0</td>\n      <td>5144.0</td>\n      <td>37282.0</td>\n      <td>9127.0</td>\n      <td>25657.0</td>\n      <td>2498.0</td>\n    </tr>\n    <tr>\n      <th>814</th>\n      <td>WISCONSIN</td>\n      <td>False</td>\n      <td>2016</td>\n      <td>23163</td>\n      <td>False</td>\n      <td>False</td>\n      <td>5772917.0</td>\n      <td>17716.0</td>\n      <td>232.0</td>\n      <td>1788.339119</td>\n      <td>2005.0</td>\n      <td>4707.0</td>\n      <td>10772.0</td>\n      <td>111911.0</td>\n      <td>19498.0</td>\n      <td>82455.0</td>\n      <td>9958.0</td>\n    </tr>\n    <tr>\n      <th>815</th>\n      <td>WYOMING</td>\n      <td>False</td>\n      <td>2016</td>\n      <td>2352</td>\n      <td>False</td>\n      <td>False</td>\n      <td>584910.0</td>\n      <td>1431.0</td>\n      <td>20.0</td>\n      <td>1788.339119</td>\n      <td>206.0</td>\n      <td>59.0</td>\n      <td>1146.0</td>\n      <td>11460.0</td>\n      <td>1771.0</td>\n      <td>8889.0</td>\n      <td>800.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>799 rows × 17 columns</p>\n</div>","text/plain":"      jurisdiction  includes_jails  year  prisoner_count  \\\n1          ALABAMA           False  2001           24741   \n2           ALASKA            True  2001            4570   \n3          ARIZONA           False  2001           27710   \n4         ARKANSAS           False  2001           11489   \n5       CALIFORNIA           False  2001          157142   \n..             ...             ...   ...             ...   \n811       VIRGINIA           False  2016           29882   \n812     WASHINGTON           False  2016           17228   \n813  WEST VIRGINIA           False  2016            5899   \n814      WISCONSIN           False  2016           23163   \n815        WYOMING           False  2016            2352   \n\n    crime_reporting_change crimes_estimated  state_population  \\\n1                    False            False         4468912.0   \n2                    False            False          633630.0   \n3                    False            False         5306966.0   \n4                    False            False         2694698.0   \n5                    False            False        34600463.0   \n..                     ...              ...               ...   \n811                  False            False         8414380.0   \n812                  False            False         7280934.0   \n813                  False            False         1828637.0   \n814                  False            False         5772917.0   \n815                  False            False          584910.0   \n\n     violent_crime_total  murder_manslaughter  rape_legacy  rape_revised  \\\n1                19582.0                379.0  1369.000000           NaN   \n2                 3735.0                 39.0   501.000000           NaN   \n3                28675.0                400.0  1518.000000           NaN   \n4                12190.0                148.0   892.000000           NaN   \n5               212867.0               2206.0  9960.000000           NaN   \n..                   ...                  ...          ...           ...   \n811              18495.0                482.0  1788.339119        2830.0   \n812              22101.0                195.0  1788.339119        3133.0   \n813               6633.0                 85.0  1788.339119         684.0   \n814              17716.0                232.0  1788.339119        2005.0   \n815               1431.0                 20.0  1788.339119         206.0   \n\n     robbery  agg_assault  property_crime_total  burglary   larceny  \\\n1     5584.0      12250.0              173253.0   40642.0  119992.0   \n2      514.0       2681.0               23160.0    3847.0   16695.0   \n3     8868.0      17889.0              293874.0   54821.0  186850.0   \n4     2181.0       8969.0               99106.0   22196.0   69590.0   \n5    64614.0     136087.0             1134189.0  232273.0  697739.0   \n..       ...          ...                   ...       ...       ...   \n811   4826.0      10357.0              157292.0   20159.0  127285.0   \n812   5649.0      13124.0              254994.0   49249.0  173423.0   \n813    720.0       5144.0               37282.0    9127.0   25657.0   \n814   4707.0      10772.0              111911.0   19498.0   82455.0   \n815     59.0       1146.0               11460.0    1771.0    8889.0   \n\n     vehicle_theft  \n1          12619.0  \n2           2618.0  \n3          52203.0  \n4           7320.0  \n5         204177.0  \n..             ...  \n811         9848.0  \n812        32322.0  \n813         2498.0  \n814         9958.0  \n815          800.0  \n\n[799 rows x 17 columns]"},"exec_count":77,"output_type":"execute_result"}},"pos":7,"type":"cell"}
{"cell_type":"code","exec_count":78,"id":"824753","input":"# drop any remaining null values in rows\ncrime_df = crime_df.drop('rape_revised', axis = 1)\ncrime_df = crime_df.drop('larceny', axis = 1) \ncrime_df = crime_df.drop('robbery', axis = 1)\ncrime_df = crime_df.drop('vehicle_theft', axis = 1)\ncrime_df.info()","output":{"0":{"name":"stdout","output_type":"stream","text":"<class 'pandas.core.frame.DataFrame'>\nInt64Index: 799 entries, 1 to 815\nData columns (total 13 columns):\n #   Column                  Non-Null Count  Dtype  \n---  ------                  --------------  -----  \n 0   jurisdiction            799 non-null    object \n 1   includes_jails          799 non-null    bool   \n 2   year                    799 non-null    int64  \n 3   prisoner_count          799 non-null    int64  \n 4   crime_reporting_change  799 non-null    object \n 5   crimes_estimated        799 non-null    object \n 6   state_population        799 non-null    float64\n 7   violent_crime_total     799 non-null    float64\n 8   murder_manslaughter     799 non-null    float64\n 9   rape_legacy             799 non-null    float64\n 10  agg_assault             799 non-null    float64\n 11  property_crime_total    799 non-null    float64\n 12  burglary                799 non-null    float64\ndtypes: bool(1), float64(7), int64(2), object(3)\nmemory usage: 81.9+ KB\n"}},"pos":8,"type":"cell"}
{"cell_type":"code","exec_count":79,"id":"84b540","input":"# checking for null values in the each column of the dataset\ncrime_df.isnull().sum()","output":{"0":{"data":{"text/plain":"jurisdiction              0\nincludes_jails            0\nyear                      0\nprisoner_count            0\ncrime_reporting_change    0\ncrimes_estimated          0\nstate_population          0\nviolent_crime_total       0\nmurder_manslaughter       0\nrape_legacy               0\nagg_assault               0\nproperty_crime_total      0\nburglary                  0\ndtype: int64"},"exec_count":79,"output_type":"execute_result"}},"pos":9,"type":"cell"}
{"cell_type":"code","exec_count":80,"id":"d3c84e","input":"# Plot 1: Prisoner Count per state\n\nfig = px.line(crime_df, x='jurisdiction', y='prisoner_count', color = 'year')\nfig.show()\nfig.write_html(\"prisonerperstate.html\")","output":{"0":{"data":{"iframe":"18d4b4c2ea80b3ae300f35dd43faab47212cd986"},"exec_count":80,"output_type":"execute_result"}},"pos":11,"type":"cell"}
{"cell_type":"code","exec_count":81,"id":"c62200","input":"# Plot 2: Murder-Manslaughter per state\n\nfig = px.bar(crime_df, x='jurisdiction', y='murder_manslaughter', color = 'year', title = \"Murder-Manslaughter per State\", labels = {\"jurisdiction\":\"States\", \"murder_manslaughter\":\"Murder-Manslaughter\"})\nfig.show()\nfig.write_html(\"manslaughterperstate.html\")","output":{"0":{"data":{"iframe":"405c8849db0c67a380bff48236054f5604adbcf0"},"exec_count":81,"output_type":"execute_result"}},"pos":12,"type":"cell"}
{"cell_type":"code","exec_count":82,"id":"bb4b12","input":"# Plot 3: Burglary per state\n\nfig = px.scatter(crime_df, x ='jurisdiction', y = 'burglary', color='prisoner_count', title = \"Burglary per State\", labels = {\"jurisdiction\":\"States\", \"burglary\":\"Burglary\"})\nfig.show()\nfig.write_html(\"burglaryperstate.html\")","output":{"0":{"data":{"iframe":"9496c1100d03a69941acab71451acf9fde0d74bc"},"exec_count":82,"output_type":"execute_result"}},"pos":13,"type":"cell"}
{"cell_type":"code","exec_count":84,"id":"e288b9","input":"# Plot 5: Includes jail or not based on the crimes\n\npath=['murder_manslaughter','rape_legacy','agg_assault','burglary']\nfig = px.bar(crime_df, x=\"jurisdiction\", y=path, hover_data = [\"includes_jails\",\"year\"], title=\"Includes jail or not based on the crimes\")\nfig.show()\nfig.write_html(\"includes_jails.html\")","output":{"0":{"data":{"iframe":"7a46e05df88b27f05c886b0d1261eb0cbccecc53"},"exec_count":84,"output_type":"execute_result"}},"pos":15,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":87,"id":"fb7edd","input":"corr=crime_df.corr()\ncorr.style.background_gradient(cmap='coolwarm')","output":{"0":{"data":{"text/html":"<style type=\"text/css\">\n#T_70399_row0_col0, #T_70399_row1_col1, #T_70399_row2_col2, #T_70399_row3_col3, #T_70399_row4_col4, #T_70399_row5_col5, #T_70399_row6_col6, #T_70399_row7_col7, #T_70399_row8_col8, #T_70399_row9_col9 {\n  background-color: #b40426;\n  color: #f1f1f1;\n}\n#T_70399_row0_col1 {\n  background-color: #516ddb;\n  color: #f1f1f1;\n}\n#T_70399_row0_col2, #T_70399_row0_col3, #T_70399_row0_col4, #T_70399_row0_col5, #T_70399_row0_col6, #T_70399_row0_col7, #T_70399_row0_col8, #T_70399_row0_col9, #T_70399_row6_col0, #T_70399_row8_col1 {\n  background-color: #3b4cc0;\n  color: #f1f1f1;\n}\n#T_70399_row1_col0 {\n  background-color: #80a3fa;\n  color: #f1f1f1;\n}\n#T_70399_row1_col2, #T_70399_row1_col6 {\n  background-color: #7597f6;\n  color: #f1f1f1;\n}\n#T_70399_row1_col3 {\n  background-color: #86a9fc;\n  color: #f1f1f1;\n}\n#T_70399_row1_col4, #T_70399_row1_col7, #T_70399_row1_col9 {\n  background-color: #6b8df0;\n  color: #f1f1f1;\n}\n#T_70399_row1_col5 {\n  background-color: #779af7;\n  color: #f1f1f1;\n}\n#T_70399_row1_col8 {\n  background-color: #6788ee;\n  color: #f1f1f1;\n}\n#T_70399_row2_col0, #T_70399_row6_col1 {\n  background-color: #465ecf;\n  color: #f1f1f1;\n}\n#T_70399_row2_col1 {\n  background-color: #536edd;\n  color: #f1f1f1;\n}\n#T_70399_row2_col3, #T_70399_row5_col8, #T_70399_row8_col5 {\n  background-color: #c32e31;\n  color: #f1f1f1;\n}\n#T_70399_row2_col4, #T_70399_row4_col2, #T_70399_row4_col9, #T_70399_row5_col2, #T_70399_row6_col8, #T_70399_row8_col6, #T_70399_row9_col4 {\n  background-color: #c53334;\n  color: #f1f1f1;\n}\n#T_70399_row2_col5, #T_70399_row3_col2 {\n  background-color: #c43032;\n  color: #f1f1f1;\n}\n#T_70399_row2_col6, #T_70399_row3_col9, #T_70399_row9_col3 {\n  background-color: #cb3e38;\n  color: #f1f1f1;\n}\n#T_70399_row2_col7, #T_70399_row5_col9, #T_70399_row6_col9, #T_70399_row7_col2, #T_70399_row9_col5 {\n  background-color: #ca3b37;\n  color: #f1f1f1;\n}\n#T_70399_row2_col8, #T_70399_row4_col5, #T_70399_row4_col8, #T_70399_row5_col4, #T_70399_row8_col2 {\n  background-color: #bd1f2d;\n  color: #f1f1f1;\n}\n#T_70399_row2_col9, #T_70399_row3_col5, #T_70399_row3_col8, #T_70399_row5_col3, #T_70399_row5_col7, #T_70399_row7_col5, #T_70399_row7_col8, #T_70399_row8_col3, #T_70399_row8_col7, #T_70399_row9_col2 {\n  background-color: #c12b30;\n  color: #f1f1f1;\n}\n#T_70399_row3_col0, #T_70399_row5_col0, #T_70399_row8_col0, #T_70399_row9_col0 {\n  background-color: #3c4ec2;\n  color: #f1f1f1;\n}\n#T_70399_row3_col1 {\n  background-color: #5a78e4;\n  color: #f1f1f1;\n}\n#T_70399_row3_col4, #T_70399_row4_col3 {\n  background-color: #c0282f;\n  color: #f1f1f1;\n}\n#T_70399_row3_col6, #T_70399_row6_col7 {\n  background-color: #d0473d;\n  color: #f1f1f1;\n}\n#T_70399_row3_col7, #T_70399_row7_col3, #T_70399_row7_col9 {\n  background-color: #c73635;\n  color: #f1f1f1;\n}\n#T_70399_row4_col0, #T_70399_row7_col0 {\n  background-color: #4055c8;\n  color: #f1f1f1;\n}\n#T_70399_row4_col1, #T_70399_row7_col1 {\n  background-color: #4358cb;\n  color: #f1f1f1;\n}\n#T_70399_row4_col6, #T_70399_row6_col2, #T_70399_row6_col4 {\n  background-color: #cc403a;\n  color: #f1f1f1;\n}\n#T_70399_row4_col7, #T_70399_row7_col4 {\n  background-color: #b50927;\n  color: #f1f1f1;\n}\n#T_70399_row5_col1 {\n  background-color: #4a63d3;\n  color: #f1f1f1;\n}\n#T_70399_row5_col6, #T_70399_row6_col5 {\n  background-color: #d24b40;\n  color: #f1f1f1;\n}\n#T_70399_row6_col3 {\n  background-color: #d1493f;\n  color: #f1f1f1;\n}\n#T_70399_row7_col6 {\n  background-color: #cf453c;\n  color: #f1f1f1;\n}\n#T_70399_row8_col4 {\n  background-color: #be242e;\n  color: #f1f1f1;\n}\n#T_70399_row8_col9, #T_70399_row9_col8 {\n  background-color: #b70d28;\n  color: #f1f1f1;\n}\n#T_70399_row9_col1 {\n  background-color: #3e51c5;\n  color: #f1f1f1;\n}\n#T_70399_row9_col6, #T_70399_row9_col7 {\n  background-color: #c83836;\n  color: #f1f1f1;\n}\n</style>\n<table id=\"T_70399\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_70399_level0_col0\" class=\"col_heading level0 col0\" >includes_jails</th>\n      <th id=\"T_70399_level0_col1\" class=\"col_heading level0 col1\" >year</th>\n      <th id=\"T_70399_level0_col2\" class=\"col_heading level0 col2\" >prisoner_count</th>\n      <th id=\"T_70399_level0_col3\" class=\"col_heading level0 col3\" >state_population</th>\n      <th id=\"T_70399_level0_col4\" class=\"col_heading level0 col4\" >violent_crime_total</th>\n      <th id=\"T_70399_level0_col5\" class=\"col_heading level0 col5\" >murder_manslaughter</th>\n      <th id=\"T_70399_level0_col6\" class=\"col_heading level0 col6\" >rape_legacy</th>\n      <th id=\"T_70399_level0_col7\" class=\"col_heading level0 col7\" >agg_assault</th>\n      <th id=\"T_70399_level0_col8\" class=\"col_heading level0 col8\" >property_crime_total</th>\n      <th id=\"T_70399_level0_col9\" class=\"col_heading level0 col9\" >burglary</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_70399_level0_row0\" class=\"row_heading level0 row0\" >includes_jails</th>\n      <td id=\"T_70399_row0_col0\" class=\"data row0 col0\" >1.000000</td>\n      <td id=\"T_70399_row0_col1\" class=\"data row0 col1\" >0.000653</td>\n      <td id=\"T_70399_row0_col2\" class=\"data row0 col2\" >-0.212966</td>\n      <td id=\"T_70399_row0_col3\" class=\"data row0 col3\" >-0.259495</td>\n      <td id=\"T_70399_row0_col4\" class=\"data row0 col4\" >-0.237818</td>\n      <td id=\"T_70399_row0_col5\" class=\"data row0 col5\" >-0.259815</td>\n      <td id=\"T_70399_row0_col6\" class=\"data row0 col6\" >-0.266943</td>\n      <td id=\"T_70399_row0_col7\" class=\"data row0 col7\" >-0.240870</td>\n      <td id=\"T_70399_row0_col8\" class=\"data row0 col8\" >-0.259262</td>\n      <td id=\"T_70399_row0_col9\" class=\"data row0 col9\" >-0.261738</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row1\" class=\"row_heading level0 row1\" >year</th>\n      <td id=\"T_70399_row1_col0\" class=\"data row1 col0\" >0.000653</td>\n      <td id=\"T_70399_row1_col1\" class=\"data row1 col1\" >1.000000</td>\n      <td id=\"T_70399_row1_col2\" class=\"data row1 col2\" >0.006612</td>\n      <td id=\"T_70399_row1_col3\" class=\"data row1 col3\" >0.031225</td>\n      <td id=\"T_70399_row1_col4\" class=\"data row1 col4\" >-0.047506</td>\n      <td id=\"T_70399_row1_col5\" class=\"data row1 col5\" >-0.021080</td>\n      <td id=\"T_70399_row1_col6\" class=\"data row1 col6\" >-0.036419</td>\n      <td id=\"T_70399_row1_col7\" class=\"data row1 col7\" >-0.049170</td>\n      <td id=\"T_70399_row1_col8\" class=\"data row1 col8\" >-0.080039</td>\n      <td id=\"T_70399_row1_col9\" class=\"data row1 col9\" >-0.066611</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row2\" class=\"row_heading level0 row2\" >prisoner_count</th>\n      <td id=\"T_70399_row2_col0\" class=\"data row2 col0\" >-0.212966</td>\n      <td id=\"T_70399_row2_col1\" class=\"data row2 col1\" >0.006612</td>\n      <td id=\"T_70399_row2_col2\" class=\"data row2 col2\" >1.000000</td>\n      <td id=\"T_70399_row2_col3\" class=\"data row2 col3\" >0.946487</td>\n      <td id=\"T_70399_row2_col4\" class=\"data row2 col4\" >0.941173</td>\n      <td id=\"T_70399_row2_col5\" class=\"data row2 col5\" >0.942476</td>\n      <td id=\"T_70399_row2_col6\" class=\"data row2 col6\" >0.916983</td>\n      <td id=\"T_70399_row2_col7\" class=\"data row2 col7\" >0.926015</td>\n      <td id=\"T_70399_row2_col8\" class=\"data row2 col8\" >0.968866</td>\n      <td id=\"T_70399_row2_col9\" class=\"data row2 col9\" >0.953372</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row3\" class=\"row_heading level0 row3\" >state_population</th>\n      <td id=\"T_70399_row3_col0\" class=\"data row3 col0\" >-0.259495</td>\n      <td id=\"T_70399_row3_col1\" class=\"data row3 col1\" >0.031225</td>\n      <td id=\"T_70399_row3_col2\" class=\"data row3 col2\" >0.946487</td>\n      <td id=\"T_70399_row3_col3\" class=\"data row3 col3\" >1.000000</td>\n      <td id=\"T_70399_row3_col4\" class=\"data row3 col4\" >0.960609</td>\n      <td id=\"T_70399_row3_col5\" class=\"data row3 col5\" >0.953897</td>\n      <td id=\"T_70399_row3_col6\" class=\"data row3 col6\" >0.896254</td>\n      <td id=\"T_70399_row3_col7\" class=\"data row3 col7\" >0.934605</td>\n      <td id=\"T_70399_row3_col8\" class=\"data row3 col8\" >0.951278</td>\n      <td id=\"T_70399_row3_col9\" class=\"data row3 col9\" >0.917524</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row4\" class=\"row_heading level0 row4\" >violent_crime_total</th>\n      <td id=\"T_70399_row4_col0\" class=\"data row4 col0\" >-0.237818</td>\n      <td id=\"T_70399_row4_col1\" class=\"data row4 col1\" >-0.047506</td>\n      <td id=\"T_70399_row4_col2\" class=\"data row4 col2\" >0.941173</td>\n      <td id=\"T_70399_row4_col3\" class=\"data row4 col3\" >0.960609</td>\n      <td id=\"T_70399_row4_col4\" class=\"data row4 col4\" >1.000000</td>\n      <td id=\"T_70399_row4_col5\" class=\"data row4 col5\" >0.969505</td>\n      <td id=\"T_70399_row4_col6\" class=\"data row4 col6\" >0.913240</td>\n      <td id=\"T_70399_row4_col7\" class=\"data row4 col7\" >0.994019</td>\n      <td id=\"T_70399_row4_col8\" class=\"data row4 col8\" >0.965846</td>\n      <td id=\"T_70399_row4_col9\" class=\"data row4 col9\" >0.939681</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row5\" class=\"row_heading level0 row5\" >murder_manslaughter</th>\n      <td id=\"T_70399_row5_col0\" class=\"data row5 col0\" >-0.259815</td>\n      <td id=\"T_70399_row5_col1\" class=\"data row5 col1\" >-0.021080</td>\n      <td id=\"T_70399_row5_col2\" class=\"data row5 col2\" >0.942476</td>\n      <td id=\"T_70399_row5_col3\" class=\"data row5 col3\" >0.953897</td>\n      <td id=\"T_70399_row5_col4\" class=\"data row5 col4\" >0.969505</td>\n      <td id=\"T_70399_row5_col5\" class=\"data row5 col5\" >1.000000</td>\n      <td id=\"T_70399_row5_col6\" class=\"data row5 col6\" >0.890569</td>\n      <td id=\"T_70399_row5_col7\" class=\"data row5 col7\" >0.952649</td>\n      <td id=\"T_70399_row5_col8\" class=\"data row5 col8\" >0.949806</td>\n      <td id=\"T_70399_row5_col9\" class=\"data row5 col9\" >0.925517</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row6\" class=\"row_heading level0 row6\" >rape_legacy</th>\n      <td id=\"T_70399_row6_col0\" class=\"data row6 col0\" >-0.266943</td>\n      <td id=\"T_70399_row6_col1\" class=\"data row6 col1\" >-0.036419</td>\n      <td id=\"T_70399_row6_col2\" class=\"data row6 col2\" >0.916983</td>\n      <td id=\"T_70399_row6_col3\" class=\"data row6 col3\" >0.896254</td>\n      <td id=\"T_70399_row6_col4\" class=\"data row6 col4\" >0.913240</td>\n      <td id=\"T_70399_row6_col5\" class=\"data row6 col5\" >0.890569</td>\n      <td id=\"T_70399_row6_col6\" class=\"data row6 col6\" >1.000000</td>\n      <td id=\"T_70399_row6_col7\" class=\"data row6 col7\" >0.902545</td>\n      <td id=\"T_70399_row6_col8\" class=\"data row6 col8\" >0.937447</td>\n      <td id=\"T_70399_row6_col9\" class=\"data row6 col9\" >0.925981</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row7\" class=\"row_heading level0 row7\" >agg_assault</th>\n      <td id=\"T_70399_row7_col0\" class=\"data row7 col0\" >-0.240870</td>\n      <td id=\"T_70399_row7_col1\" class=\"data row7 col1\" >-0.049170</td>\n      <td id=\"T_70399_row7_col2\" class=\"data row7 col2\" >0.926015</td>\n      <td id=\"T_70399_row7_col3\" class=\"data row7 col3\" >0.934605</td>\n      <td id=\"T_70399_row7_col4\" class=\"data row7 col4\" >0.994019</td>\n      <td id=\"T_70399_row7_col5\" class=\"data row7 col5\" >0.952649</td>\n      <td id=\"T_70399_row7_col6\" class=\"data row7 col6\" >0.902545</td>\n      <td id=\"T_70399_row7_col7\" class=\"data row7 col7\" >1.000000</td>\n      <td id=\"T_70399_row7_col8\" class=\"data row7 col8\" >0.954541</td>\n      <td id=\"T_70399_row7_col9\" class=\"data row7 col9\" >0.932111</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row8\" class=\"row_heading level0 row8\" >property_crime_total</th>\n      <td id=\"T_70399_row8_col0\" class=\"data row8 col0\" >-0.259262</td>\n      <td id=\"T_70399_row8_col1\" class=\"data row8 col1\" >-0.080039</td>\n      <td id=\"T_70399_row8_col2\" class=\"data row8 col2\" >0.968866</td>\n      <td id=\"T_70399_row8_col3\" class=\"data row8 col3\" >0.951278</td>\n      <td id=\"T_70399_row8_col4\" class=\"data row8 col4\" >0.965846</td>\n      <td id=\"T_70399_row8_col5\" class=\"data row8 col5\" >0.949806</td>\n      <td id=\"T_70399_row8_col6\" class=\"data row8 col6\" >0.937447</td>\n      <td id=\"T_70399_row8_col7\" class=\"data row8 col7\" >0.954541</td>\n      <td id=\"T_70399_row8_col8\" class=\"data row8 col8\" >1.000000</td>\n      <td id=\"T_70399_row8_col9\" class=\"data row8 col9\" >0.985963</td>\n    </tr>\n    <tr>\n      <th id=\"T_70399_level0_row9\" class=\"row_heading level0 row9\" >burglary</th>\n      <td id=\"T_70399_row9_col0\" class=\"data row9 col0\" >-0.261738</td>\n      <td id=\"T_70399_row9_col1\" class=\"data row9 col1\" >-0.066611</td>\n      <td id=\"T_70399_row9_col2\" class=\"data row9 col2\" >0.953372</td>\n      <td id=\"T_70399_row9_col3\" class=\"data row9 col3\" >0.917524</td>\n      <td id=\"T_70399_row9_col4\" class=\"data row9 col4\" >0.939681</td>\n      <td id=\"T_70399_row9_col5\" class=\"data row9 col5\" >0.925517</td>\n      <td id=\"T_70399_row9_col6\" class=\"data row9 col6\" >0.925981</td>\n      <td id=\"T_70399_row9_col7\" class=\"data row9 col7\" >0.932111</td>\n      <td id=\"T_70399_row9_col8\" class=\"data row9 col8\" >0.985963</td>\n      <td id=\"T_70399_row9_col9\" class=\"data row9 col9\" >1.000000</td>\n    </tr>\n  </tbody>\n</table>\n","text/plain":"<pandas.io.formats.style.Styler at 0x7f4bb8993370>"},"exec_count":87,"output_type":"execute_result"}},"pos":20,"type":"cell"}
{"cell_type":"code","exec_count":89,"id":"0950c5","input":"# A correlation plot helps provide a visualization of the correlation between independent variables in the dataset. Correlation plots have three different types of correlation between variables; positive correlation, negative correlation, and zero correlation. When two variables increase or decrease together, they have a positive correlation, which is represented by a 1. When one variable increases and the other variable decreases, it is a negative correlation, which is represented by a -1. When two variables have no impact on each other, there is zero correlation, which is represented by a 0. Collinearity is the correlation between variables that expresses a linear relation in a regression model. Correlation indicates the strength of the linear relationship that might be existing between two variables. High Collinearity among these variables causes over fitting in the model. To avoid this its suggested to drop such variables.","pos":21,"type":"cell"}
{"cell_type":"code","exec_count":90,"id":"cf63ad","input":"labelencoder = LabelEncoder()\ncrime_df['jurisdiction Labels'] = labelencoder.fit_transform(crime_df[\"jurisdiction\"])\ncrime_df['includes_jails Labels'] = labelencoder.fit_transform(crime_df[\"includes_jails\"])\ncrime_df['jurisdiction'] = crime_df['jurisdiction Labels']\ncrime_df['includes_jails'] = crime_df['includes_jails Labels']\ncrime_df","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>jurisdiction</th>\n      <th>includes_jails</th>\n      <th>year</th>\n      <th>prisoner_count</th>\n      <th>crime_reporting_change</th>\n      <th>crimes_estimated</th>\n      <th>state_population</th>\n      <th>violent_crime_total</th>\n      <th>murder_manslaughter</th>\n      <th>rape_legacy</th>\n      <th>agg_assault</th>\n      <th>property_crime_total</th>\n      <th>burglary</th>\n      <th>jurisdiction Labels</th>\n      <th>includes_jails Labels</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>0</td>\n      <td>2001</td>\n      <td>24741</td>\n      <td>False</td>\n      <td>False</td>\n      <td>4468912.0</td>\n      <td>19582.0</td>\n      <td>379.0</td>\n      <td>1369.000000</td>\n      <td>12250.0</td>\n      <td>173253.0</td>\n      <td>40642.0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1</td>\n      <td>1</td>\n      <td>2001</td>\n      <td>4570</td>\n      <td>False</td>\n      <td>False</td>\n      <td>633630.0</td>\n      <td>3735.0</td>\n      <td>39.0</td>\n      <td>501.000000</td>\n      <td>2681.0</td>\n      <td>23160.0</td>\n      <td>3847.0</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2</td>\n      <td>0</td>\n      <td>2001</td>\n      <td>27710</td>\n      <td>False</td>\n      <td>False</td>\n      <td>5306966.0</td>\n      <td>28675.0</td>\n      <td>400.0</td>\n      <td>1518.000000</td>\n      <td>17889.0</td>\n      <td>293874.0</td>\n      <td>54821.0</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>3</td>\n      <td>0</td>\n      <td>2001</td>\n      <td>11489</td>\n      <td>False</td>\n      <td>False</td>\n      <td>2694698.0</td>\n      <td>12190.0</td>\n      <td>148.0</td>\n      <td>892.000000</td>\n      <td>8969.0</td>\n      <td>99106.0</td>\n      <td>22196.0</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>4</td>\n      <td>0</td>\n      <td>2001</td>\n      <td>157142</td>\n      <td>False</td>\n      <td>False</td>\n      <td>34600463.0</td>\n      <td>212867.0</td>\n      <td>2206.0</td>\n      <td>9960.000000</td>\n      <td>136087.0</td>\n      <td>1134189.0</td>\n      <td>232273.0</td>\n      <td>4</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>811</th>\n      <td>45</td>\n      <td>0</td>\n      <td>2016</td>\n      <td>29882</td>\n      <td>False</td>\n      <td>False</td>\n      <td>8414380.0</td>\n      <td>18495.0</td>\n      <td>482.0</td>\n      <td>1788.339119</td>\n      <td>10357.0</td>\n      <td>157292.0</td>\n      <td>20159.0</td>\n      <td>45</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>812</th>\n      <td>46</td>\n      <td>0</td>\n      <td>2016</td>\n      <td>17228</td>\n      <td>False</td>\n      <td>False</td>\n      <td>7280934.0</td>\n      <td>22101.0</td>\n      <td>195.0</td>\n      <td>1788.339119</td>\n      <td>13124.0</td>\n      <td>254994.0</td>\n      <td>49249.0</td>\n      <td>46</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>813</th>\n      <td>47</td>\n      <td>0</td>\n      <td>2016</td>\n      <td>5899</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1828637.0</td>\n      <td>6633.0</td>\n      <td>85.0</td>\n      <td>1788.339119</td>\n      <td>5144.0</td>\n      <td>37282.0</td>\n      <td>9127.0</td>\n      <td>47</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>814</th>\n      <td>48</td>\n      <td>0</td>\n      <td>2016</td>\n      <td>23163</td>\n      <td>False</td>\n      <td>False</td>\n      <td>5772917.0</td>\n      <td>17716.0</td>\n      <td>232.0</td>\n      <td>1788.339119</td>\n      <td>10772.0</td>\n      <td>111911.0</td>\n      <td>19498.0</td>\n      <td>48</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>815</th>\n      <td>49</td>\n      <td>0</td>\n      <td>2016</td>\n      <td>2352</td>\n      <td>False</td>\n      <td>False</td>\n      <td>584910.0</td>\n      <td>1431.0</td>\n      <td>20.0</td>\n      <td>1788.339119</td>\n      <td>1146.0</td>\n      <td>11460.0</td>\n      <td>1771.0</td>\n      <td>49</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>799 rows × 15 columns</p>\n</div>","text/plain":"     jurisdiction  includes_jails  year  prisoner_count  \\\n1               0               0  2001           24741   \n2               1               1  2001            4570   \n3               2               0  2001           27710   \n4               3               0  2001           11489   \n5               4               0  2001          157142   \n..            ...             ...   ...             ...   \n811            45               0  2016           29882   \n812            46               0  2016           17228   \n813            47               0  2016            5899   \n814            48               0  2016           23163   \n815            49               0  2016            2352   \n\n    crime_reporting_change crimes_estimated  state_population  \\\n1                    False            False         4468912.0   \n2                    False            False          633630.0   \n3                    False            False         5306966.0   \n4                    False            False         2694698.0   \n5                    False            False        34600463.0   \n..                     ...              ...               ...   \n811                  False            False         8414380.0   \n812                  False            False         7280934.0   \n813                  False            False         1828637.0   \n814                  False            False         5772917.0   \n815                  False            False          584910.0   \n\n     violent_crime_total  murder_manslaughter  rape_legacy  agg_assault  \\\n1                19582.0                379.0  1369.000000      12250.0   \n2                 3735.0                 39.0   501.000000       2681.0   \n3                28675.0                400.0  1518.000000      17889.0   \n4                12190.0                148.0   892.000000       8969.0   \n5               212867.0               2206.0  9960.000000     136087.0   \n..                   ...                  ...          ...          ...   \n811              18495.0                482.0  1788.339119      10357.0   \n812              22101.0                195.0  1788.339119      13124.0   \n813               6633.0                 85.0  1788.339119       5144.0   \n814              17716.0                232.0  1788.339119      10772.0   \n815               1431.0                 20.0  1788.339119       1146.0   \n\n     property_crime_total  burglary  jurisdiction Labels  \\\n1                173253.0   40642.0                    0   \n2                 23160.0    3847.0                    1   \n3                293874.0   54821.0                    2   \n4                 99106.0   22196.0                    3   \n5               1134189.0  232273.0                    4   \n..                    ...       ...                  ...   \n811              157292.0   20159.0                   45   \n812              254994.0   49249.0                   46   \n813               37282.0    9127.0                   47   \n814              111911.0   19498.0                   48   \n815               11460.0    1771.0                   49   \n\n     includes_jails Labels  \n1                        0  \n2                        1  \n3                        0  \n4                        0  \n5                        0  \n..                     ...  \n811                      0  \n812                      0  \n813                      0  \n814                      0  \n815                      0  \n\n[799 rows x 15 columns]"},"exec_count":90,"output_type":"execute_result"}},"pos":25,"type":"cell"}
{"cell_type":"code","exec_count":91,"id":"d1543d","input":"training_features = ['jurisdiction','includes_jails','state_population','violent_crime_total','murder_manslaughter','rape_legacy','agg_assault','property_crime_total','burglary']\ntarget = 'prisoner_count'","pos":26,"type":"cell"}
{"cell_type":"code","exec_count":92,"id":"da0521","input":"#new_cdf = jurisdiction, includes_jail, state_population, violent_crime_total, rape_revised, murder_manslaughter, agg_assault, property_crime_total, burglary \ntrain, test = train_test_split(crime_df, test_size=0.2, shuffle=True)\ntrain_X = train[training_features]\ntrain_Y = train[target]\ntest_X = test[training_features]\ntest_Y = test[target]\nprint(test_X.shape[0], test_Y.shape[0])\ntrain_X","output":{"0":{"name":"stdout","output_type":"stream","text":"160 160\n"},"1":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>jurisdiction</th>\n      <th>includes_jails</th>\n      <th>state_population</th>\n      <th>violent_crime_total</th>\n      <th>murder_manslaughter</th>\n      <th>rape_legacy</th>\n      <th>agg_assault</th>\n      <th>property_crime_total</th>\n      <th>burglary</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>430</th>\n      <td>21</td>\n      <td>0</td>\n      <td>9969727.0</td>\n      <td>49825.0</td>\n      <td>623.0</td>\n      <td>4524.0</td>\n      <td>32251.0</td>\n      <td>284019.0</td>\n      <td>76046.0</td>\n    </tr>\n    <tr>\n      <th>535</th>\n      <td>24</td>\n      <td>0</td>\n      <td>6008984.0</td>\n      <td>26888.0</td>\n      <td>366.0</td>\n      <td>1469.0</td>\n      <td>18778.0</td>\n      <td>199085.0</td>\n      <td>44875.0</td>\n    </tr>\n    <tr>\n      <th>401</th>\n      <td>43</td>\n      <td>0</td>\n      <td>2736424.0</td>\n      <td>6165.0</td>\n      <td>41.0</td>\n      <td>915.0</td>\n      <td>3788.0</td>\n      <td>92373.0</td>\n      <td>14766.0</td>\n    </tr>\n    <tr>\n      <th>151</th>\n      <td>48</td>\n      <td>0</td>\n      <td>5474290.0</td>\n      <td>12104.0</td>\n      <td>183.0</td>\n      <td>1202.0</td>\n      <td>6322.0</td>\n      <td>157684.0</td>\n      <td>26546.0</td>\n    </tr>\n    <tr>\n      <th>414</th>\n      <td>5</td>\n      <td>0</td>\n      <td>5024748.0</td>\n      <td>17022.0</td>\n      <td>159.0</td>\n      <td>2269.0</td>\n      <td>11223.0</td>\n      <td>134196.0</td>\n      <td>26637.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>757</th>\n      <td>42</td>\n      <td>0</td>\n      <td>27469114.0</td>\n      <td>113227.0</td>\n      <td>1316.0</td>\n      <td>8925.0</td>\n      <td>67727.0</td>\n      <td>777739.0</td>\n      <td>153054.0</td>\n    </tr>\n    <tr>\n      <th>392</th>\n      <td>34</td>\n      <td>0</td>\n      <td>11485910.0</td>\n      <td>40436.0</td>\n      <td>547.0</td>\n      <td>4531.0</td>\n      <td>16652.0</td>\n      <td>391667.0</td>\n      <td>102428.0</td>\n    </tr>\n    <tr>\n      <th>232</th>\n      <td>27</td>\n      <td>0</td>\n      <td>2412301.0</td>\n      <td>14654.0</td>\n      <td>206.0</td>\n      <td>1016.0</td>\n      <td>8730.0</td>\n      <td>102424.0</td>\n      <td>23481.0</td>\n    </tr>\n    <tr>\n      <th>484</th>\n      <td>24</td>\n      <td>0</td>\n      <td>5995715.0</td>\n      <td>27440.0</td>\n      <td>420.0</td>\n      <td>1445.0</td>\n      <td>19390.0</td>\n      <td>200858.0</td>\n      <td>44197.0</td>\n    </tr>\n    <tr>\n      <th>628</th>\n      <td>15</td>\n      <td>0</td>\n      <td>2895801.0</td>\n      <td>9928.0</td>\n      <td>117.0</td>\n      <td>1003.0</td>\n      <td>7177.0</td>\n      <td>85704.0</td>\n      <td>17476.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>639 rows × 9 columns</p>\n</div>","text/plain":"     jurisdiction  includes_jails  state_population  violent_crime_total  \\\n430            21               0         9969727.0              49825.0   \n535            24               0         6008984.0              26888.0   \n401            43               0         2736424.0               6165.0   \n151            48               0         5474290.0              12104.0   \n414             5               0         5024748.0              17022.0   \n..            ...             ...               ...                  ...   \n757            42               0        27469114.0             113227.0   \n392            34               0        11485910.0              40436.0   \n232            27               0         2412301.0              14654.0   \n484            24               0         5995715.0              27440.0   \n628            15               0         2895801.0               9928.0   \n\n     murder_manslaughter  rape_legacy  agg_assault  property_crime_total  \\\n430                623.0       4524.0      32251.0              284019.0   \n535                366.0       1469.0      18778.0              199085.0   \n401                 41.0        915.0       3788.0               92373.0   \n151                183.0       1202.0       6322.0              157684.0   \n414                159.0       2269.0      11223.0              134196.0   \n..                   ...          ...          ...                   ...   \n757               1316.0       8925.0      67727.0              777739.0   \n392                547.0       4531.0      16652.0              391667.0   \n232                206.0       1016.0       8730.0              102424.0   \n484                420.0       1445.0      19390.0              200858.0   \n628                117.0       1003.0       7177.0               85704.0   \n\n     burglary  \n430   76046.0  \n535   44875.0  \n401   14766.0  \n151   26546.0  \n414   26637.0  \n..        ...  \n757  153054.0  \n392  102428.0  \n232   23481.0  \n484   44197.0  \n628   17476.0  \n\n[639 rows x 9 columns]"},"exec_count":92,"output_type":"execute_result"}},"pos":27,"type":"cell"}
{"cell_type":"code","exec_count":93,"id":"5f7fe9","input":"model = LinearRegression()\nmodel.fit(train_X, train_Y)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-4\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-8\" type=\"checkbox\" checked><label for=\"sk-estimator-id-8\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearRegression</label><div class=\"sk-toggleable__content\"><pre>LinearRegression()</pre></div></div></div></div></div>","text/plain":"LinearRegression()"},"exec_count":93,"output_type":"execute_result"}},"pos":29,"type":"cell"}
{"cell_type":"code","exec_count":94,"id":"3c19ac","input":"train_pred_Y = model.predict(train_X)\ntest_pred_Y = model.predict(test_X)\ntrain_pred_Y = pd.Series(train_pred_Y.clip(0, train_pred_Y.max()), index=train_Y.index)\ntest_pred_Y = pd.Series(test_pred_Y.clip(0, test_pred_Y.max()), index=test_Y.index)","pos":30,"type":"cell"}
{"cell_type":"code","exec_count":95,"id":"3650b6","input":"# Evaluation Metrics\nprint(\"Mean Absolute Error: \", mean_absolute_error(np.array(test_Y), test_pred_Y))\nprint(\"Mean Squared Error:\", mean_squared_error(test_Y, test_pred_Y))\nprint(\"R-Squared value:\", r2_score(test_Y, test_pred_Y))\n\n# Accuracy\nresult = model.score(test_X, test_Y)\nprint(\"Accuracy: \", result)","output":{"0":{"name":"stdout","output_type":"stream","text":"Mean Absolute Error:  4929.39201256202\nMean Squared Error: 54226936.66742434\nR-Squared value: 0.9447903707457528\nAccuracy:  0.9423719146360928\n"}},"pos":31,"type":"cell"}
{"cell_type":"code","exec_count":96,"id":"a8e920","input":"regressor_rf = RandomForestRegressor(random_state = 40)","pos":33,"type":"cell"}
{"cell_type":"code","exec_count":97,"id":"fb592b","input":"# Hyper Parameter Tuning using GridSearchCV\n\nparameters = {\"n_estimators\" : [2000, 3000, 4000], \"max_depth\":[2,4,6,8,10], \"max_features\": [\"sqrt\", \"log2\"]}\ngrid_rf = GridSearchCV(estimator=regressor_rf, param_grid=parameters, cv= 4)\ngrid_rf.fit(train_X, train_Y)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-5 {color: black;background-color: white;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-5\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(cv=4, estimator=RandomForestRegressor(random_state=40),\n             param_grid={&#x27;max_depth&#x27;: [2, 4, 6, 8, 10],\n                         &#x27;max_features&#x27;: [&#x27;sqrt&#x27;, &#x27;log2&#x27;],\n                         &#x27;n_estimators&#x27;: [2000, 3000, 4000]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-9\" type=\"checkbox\" ><label for=\"sk-estimator-id-9\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(cv=4, estimator=RandomForestRegressor(random_state=40),\n             param_grid={&#x27;max_depth&#x27;: [2, 4, 6, 8, 10],\n                         &#x27;max_features&#x27;: [&#x27;sqrt&#x27;, &#x27;log2&#x27;],\n                         &#x27;n_estimators&#x27;: [2000, 3000, 4000]})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-10\" type=\"checkbox\" ><label for=\"sk-estimator-id-10\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: RandomForestRegressor</label><div class=\"sk-toggleable__content\"><pre>RandomForestRegressor(random_state=40)</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-11\" type=\"checkbox\" ><label for=\"sk-estimator-id-11\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestRegressor</label><div class=\"sk-toggleable__content\"><pre>RandomForestRegressor(random_state=40)</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(cv=4, estimator=RandomForestRegressor(random_state=40),\n             param_grid={'max_depth': [2, 4, 6, 8, 10],\n                         'max_features': ['sqrt', 'log2'],\n                         'n_estimators': [2000, 3000, 4000]})"},"exec_count":97,"output_type":"execute_result"}},"pos":34,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":98,"id":"0950a2","input":"# Finding the best parameters\ngrid_rf.best_params_","output":{"0":{"data":{"text/plain":"{'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 3000}"},"exec_count":98,"output_type":"execute_result"}},"pos":35,"type":"cell"}
{"cell_type":"code","exec_count":99,"id":"f58611","input":"rfr = RandomForestRegressor(random_state=42, max_features='sqrt', n_estimators= 2000, max_depth=10)\nrfr.fit(train_X, train_Y)\nrandom_result = rfr.predict(test_X)\n\n# Evaluation Metrics\nprint(\"Mean Absolute Error: \", mean_absolute_error(np.array(test_Y), random_result))\nprint(\"Mean Squared Error:\", mean_squared_error(test_Y, random_result))\nprint(\"R-Squared value:\", r2_score(test_Y, random_result))\n\n\n# Accuracy\nresultrf = rfr.score(test_X, test_Y)\nprint(\"Accuracy: \", resultrf)","output":{"0":{"name":"stdout","output_type":"stream","text":"Mean Absolute Error:  1762.4088142007022\nMean Squared Error: 10866270.417087948\nR-Squared value: 0.9889368126253717\nAccuracy:  0.9889368126253717\n"}},"pos":36,"type":"cell"}
{"cell_type":"markdown","id":"298ddd","input":"## Conclusion\n\n","pos":46,"type":"cell"}
{"cell_type":"markdown","id":"318828","input":"#### Label Encoding\n\n","pos":24,"type":"cell"}
{"cell_type":"markdown","id":"33b2fb","input":"#### Random Forest Regressor\n\n","pos":32,"type":"cell"}
{"cell_type":"markdown","id":"3b253b","input":"#### Correlation Plot\n\n","pos":19,"type":"cell"}
{"cell_type":"markdown","id":"3c021d","input":"###### In this project, we intend to develop a model to make predictions for the number of prisoners we have based on the factors like burglary, larceny, man\\_slaughter, etc. depending on how many null values these columns have. Further in the next few cells in this training file, we will show up what visualizations we create to understand the factors we need to be taken into consideration.\n\n","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"4b24ee","input":"## Models\n\n","pos":23,"type":"cell"}
{"cell_type":"markdown","id":"734ede","input":"#### Decision Tree Regressor\n\n","pos":37,"type":"cell"}
{"cell_type":"markdown","id":"8dce00","input":"## Data Visualisation\n\n","pos":10,"type":"cell"}
{"cell_type":"markdown","id":"90baf1","input":"## Data Information and Cleaning\n\n","pos":3,"type":"cell"}
{"cell_type":"markdown","id":"abd0d9","input":"After doing the data analysis and model evaluation, our team came to a conclusion that the model Random Forest would work best for our dataset. Random Forest gave better accuracy after performing GridSearchCV in comparison to the linear Regression and decision trees, \n\nin which reduces the overfitting problems in decision trees and reduces the variance. Compares to decision tree, random forests are a stronger modeling technique and much more robust than a single decision tree, as they can aggregate many decision trees to limit overfitting as well as error due to bias and thefore yield usegul results. Random forests also consist of multiple single trees each based on a random sample of the training data, which were typically more accurate than single decision trees. \n\n","pos":47,"type":"cell"}
{"cell_type":"markdown","id":"cc31ed","input":"## Feature Selection & Extraction\n\n","pos":22,"type":"cell"}
{"cell_type":"markdown","id":"d2d7d0","input":"#### Linear Model\n\n","pos":28,"type":"cell"}
{"cell_type":"markdown","id":"da9398","input":"## Visualizations for the Model\n\n","pos":41,"type":"cell"}
{"cell_type":"markdown","id":"e87e7b","input":"Data Analysis for the above plot:\n\n","pos":18,"type":"cell"}
{"cell_type":"markdown","id":"ed2513","input":"## Imports\n\n","pos":1,"type":"cell"}
{"id":0,"time":1659110334549,"type":"user"}
{"last_load":1659127162386,"type":"file"}